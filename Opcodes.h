/* ============================================================================
 *  Opcodes.h: Opcode types, info, and other data.
 *
 *  VR4300SIM: NEC VR43xx Processor SIMulator.
 *  Copyright (C) 2013, Tyler J. Stachecki.
 *  All rights reserved.
 *
 *  This file is subject to the terms and conditions defined in
 *  file 'LICENSE', which is part of this source code package.
 * ========================================================================= */
#ifndef __VR4300__OPCODES_H__
#define __VR4300__OPCODES_H__
#include "Common.h"

enum VR4300OpcodeID {
#define X(op) VR4300_OPCODE_##op,
#include "Opcodes.md"
  NUM_VR4300_OPCODES
#undef X
};

struct VR4300;

#define X(op) void VR4300##op(struct VR4300 *, uint64_t, uint64_t);
#include "Opcodes.md"
#undef X

typedef void (*const VR4300Function)(struct VR4300 *, uint64_t, uint64_t);
extern const VR4300Function VR4300FunctionTable[NUM_VR4300_OPCODES];

#ifndef NDEBUG
extern const char *VR4300OpcodeMnemonics[NUM_VR4300_OPCODES];
#endif

/* ============================================================================
 *  Build every entry in the opcode database.
 *  TODO: Not (yet) complete... nor correct?
 * ========================================================================= */
#define VR4300_BUILD_OP(op, flags) \
  (VR4300_OPCODE_##op), (flags)

#define INFO1(x) (OPCODE_INFO_##x)
#define INFO2(x,y) (INFO1(x) | OPCODE_INFO_##y)
#define INFO3(x,y,z) (INFO2(x,y) | OPCODE_INFO_##z)
#define INFO4(x,y,z,a) (INFO3(x,y,z) | OPCODE_INFO_##a)
#define INFO5(x,y,z,a,b) (INFO4(x,y,z,a) | OPCODE_INFO_##b)

/* Not actual instructions; just for reference. */
#define INVALID VR4300_BUILD_OP(INV, INFO1(NONE))

/* Not actual instructions; need more decoding. */
#define BC0 VR4300_BUILD_OP(BC0, INFO1(BRANCH))
#define BC1 VR4300_BUILD_OP(BC1, INFO1(BRANCH))
#define BC2 VR4300_BUILD_OP(BC1, INFO1(BRANCH))
#define FPUS VR4300_BUILD_OP(FPUS, INFO1(NONE))
#define FPUD VR4300_BUILD_OP(FPUD, INFO1(NONE))
#define FPUW VR4300_BUILD_OP(FPUW, INFO1(NONE))
#define FPUL VR4300_BUILD_OP(FPUL, INFO1(NONE))
#define TLB VR4300_BUILD_OP(TLB, INFO1(NONE))

/* List of instructions; not complete/correct. */
#define ADD VR4300_BUILD_OP(ADD_ADDU_SUB_SUBU, INFO1(NONE))
#define ADDI VR4300_BUILD_OP(ADDI_SUBI_ADDIU_SUBIU, INFO1(NONE))
#define ADDIU VR4300_BUILD_OP(ADDI_SUBI_ADDIU_SUBIU, INFO2(NEED_RS, WRITE_RT))
#define ADDU VR4300_BUILD_OP(ADD_ADDU_SUB_SUBU, INFO1(NONE))
#define AND VR4300_BUILD_OP(AND, INFO1(NONE))
#define ANDI VR4300_BUILD_OP(ANDI, INFO2(NEED_RS, WRITE_RT))
#define BEQ VR4300_BUILD_OP(BEQ_BEQL_BNE_BNEL, INFO1(BRANCH))
#define BEQL VR4300_BUILD_OP(BEQ_BEQL_BNE_BNEL, INFO1(BRANCH))
#define BGEZ VR4300_BUILD_OP(BGEZ_BGEZL_BLTZ_BLTZL, INFO1(BRANCH))
#define BGEZAL VR4300_BUILD_OP(BGEZAL_BGEZALL_BLTZAL_BLTZALL, INFO1(BRANCH))
#define BGEZALL VR4300_BUILD_OP(BGEZAL_BGEZALL_BLTZAL_BLTZALL, INFO1(BRANCH))
#define BGEZL VR4300_BUILD_OP(BGEZ_BGEZL_BLTZ_BLTZL, INFO1(BRANCH))
#define BGTZ VR4300_BUILD_OP(BGTZ_BGTZL_BLEZ_BLEZL, INFO1(BRANCH))
#define BGTZL VR4300_BUILD_OP(BGTZ_BGTZL_BLEZ_BLEZL, INFO1(BRANCH))
#define BLEZ VR4300_BUILD_OP(BGTZ_BGTZL_BLEZ_BLEZL, INFO1(BRANCH))
#define BLEZL VR4300_BUILD_OP(BGTZ_BGTZL_BLEZ_BLEZL, INFO1(BRANCH))
#define BLTZ VR4300_BUILD_OP(BGEZ_BGEZL_BLTZ_BLTZL, INFO1(BRANCH))
#define BLTZAL VR4300_BUILD_OP(BGEZAL_BGEZALL_BLTZAL_BLTZALL, INFO1(BRANCH))
#define BLTZALL VR4300_BUILD_OP(BGEZAL_BGEZALL_BLTZAL_BLTZALL, INFO1(BRANCH))
#define BLTZL VR4300_BUILD_OP(BGEZ_BGEZL_BLTZ_BLTZL, INFO1(BRANCH))
#define BNE VR4300_BUILD_OP(BEQ_BEQL_BNE_BNEL, INFO1(BRANCH))
#define BNEL VR4300_BUILD_OP(BEQ_BEQL_BNE_BNEL, INFO1(BRANCH))
#define BREAK VR4300_BUILD_OP(BREAK, INFO1(NONE))
#define CACHE VR4300_BUILD_OP(CACHE, INFO1(NONE))
#define CFC0 VR4300_BUILD_OP(CFC0, INFO1(NONE))
#define CFC1 VR4300_BUILD_OP(CFC1, INFO1(NONE))
#define CFC2 VR4300_BUILD_OP(CFC2, INFO1(NONE))
#define COP0 VR4300_BUILD_OP(COP0, INFO1(NONE))
#define COP1 VR4300_BUILD_OP(COP1, INFO1(NONE))
#define COP2 VR4300_BUILD_OP(COP2, INFO1(NONE))
#define CTC0 VR4300_BUILD_OP(CTC0, INFO1(NONE))
#define CTC1 VR4300_BUILD_OP(CTC1, INFO1(NONE))
#define CTC2 VR4300_BUILD_OP(CTC2, INFO1(NONE))
#define DADD VR4300_BUILD_OP(DADD, INFO1(NONE))
#define DADDI VR4300_BUILD_OP(DADDI, INFO1(NONE))
#define DADDIU VR4300_BUILD_OP(DADDIU, INFO1(NONE))
#define DADDU VR4300_BUILD_OP(DADDU, INFO1(NONE))
#define DDIV VR4300_BUILD_OP(DDIV, INFO1(NONE))
#define DDIVU VR4300_BUILD_OP(DDIVU, INFO1(NONE))
#define DIV VR4300_BUILD_OP(DIV, INFO1(NONE))
#define DIVU VR4300_BUILD_OP(DIVU, INFO1(NONE))
#define DMFC0 VR4300_BUILD_OP(DMFC0, INFO1(NONE))
#define DMFC1 VR4300_BUILD_OP(DMFC1, INFO1(NONE))
#define DMFC2 VR4300_BUILD_OP(DMFC2, INFO1(NONE))
#define DMTC0 VR4300_BUILD_OP(DMTC0, INFO1(NONE))
#define DMTC1 VR4300_BUILD_OP(DMTC1, INFO1(NONE))
#define DMTC2 VR4300_BUILD_OP(DMTC2, INFO1(NONE))
#define DMULT VR4300_BUILD_OP(DMULT, INFO1(NONE))
#define DMULTU VR4300_BUILD_OP(DMULTU, INFO1(NONE))
#define DSLL VR4300_BUILD_OP(DSLL, INFO1(NONE))
#define DSLLV VR4300_BUILD_OP(DSLLV, INFO1(NONE))
#define DSLL32 VR4300_BUILD_OP(DSLL32, INFO1(NONE))
#define DSRA VR4300_BUILD_OP(DSRA, INFO1(NONE))
#define DSRAV VR4300_BUILD_OP(DSRAV, INFO1(NONE))
#define DSRA32 VR4300_BUILD_OP(DSRA32, INFO1(NONE))
#define DSRL VR4300_BUILD_OP(DSRL, INFO1(NONE))
#define DSRLV VR4300_BUILD_OP(DSRLV, INFO1(NONE))
#define DSRL32 VR4300_BUILD_OP(DSRL32, INFO1(NONE))
#define DSUB VR4300_BUILD_OP(DSUB, INFO1(NONE))
#define DSUBU VR4300_BUILD_OP(DSUBU, INFO1(NONE))
#define ERET VR4300_BUILD_OP(ERET, INFO1(NONE))
#define J VR4300_BUILD_OP(J, INFO1(BRANCH))
#define JAL VR4300_BUILD_OP(JAL, INFO1(BRANCH))
#define JALR VR4300_BUILD_OP(JALR, INFO1(BRANCH))
#define JR VR4300_BUILD_OP(JR, INFO1(BRANCH))
#define LB VR4300_BUILD_OP(LB, INFO1(NONE))
#define LBU VR4300_BUILD_OP(LBU, INFO1(NONE))
#define LD VR4300_BUILD_OP(LD, INFO1(NONE))
#define LDC0 VR4300_BUILD_OP(LDC0, INFO1(NONE))
#define LDC1 VR4300_BUILD_OP(LDC1, INFO1(NONE))
#define LDC2 VR4300_BUILD_OP(LDC2, INFO1(NONE))
#define LDL VR4300_BUILD_OP(LDL, INFO1(NONE))
#define LDR VR4300_BUILD_OP(LDR, INFO1(NONE))
#define LH VR4300_BUILD_OP(LH, INFO1(NONE))
#define LHU VR4300_BUILD_OP(LHU, INFO1(NONE))
#define LL VR4300_BUILD_OP(LL, INFO1(NONE))
#define LLD VR4300_BUILD_OP(LLD, INFO1(NONE))
#define LUI VR4300_BUILD_OP(LUI, INFO1(WRITE_RT))
#define LW VR4300_BUILD_OP(LW, INFO1(NONE))
#define LWC0 VR4300_BUILD_OP(LWC0, INFO1(NONE))
#define LWC1 VR4300_BUILD_OP(LWC1, INFO1(NONE))
#define LWC2 VR4300_BUILD_OP(LWC2, INFO1(NONE))
#define LWL VR4300_BUILD_OP(LWL, INFO1(NONE))
#define LWR VR4300_BUILD_OP(LWR, INFO1(NONE))
#define LWU VR4300_BUILD_OP(LWU, INFO1(NONE))
#define MFC0 VR4300_BUILD_OP(MFC0, INFO1(NONE))
#define MFC1 VR4300_BUILD_OP(MFC1, INFO1(NONE))
#define MFC2 VR4300_BUILD_OP(MFC2, INFO1(NONE))
#define MFHI VR4300_BUILD_OP(MFHI, INFO1(NONE))
#define MFLO VR4300_BUILD_OP(MFLO, INFO1(NONE))
#define MTC0 VR4300_BUILD_OP(MTC0, INFO1(NONE))
#define MTC1 VR4300_BUILD_OP(MTC1, INFO1(NONE))
#define MTC2 VR4300_BUILD_OP(MTC2, INFO1(NONE))
#define MTHI VR4300_BUILD_OP(MTHI, INFO1(NONE))
#define MTLO VR4300_BUILD_OP(MTLO, INFO1(NONE))
#define MULT VR4300_BUILD_OP(MULT, INFO1(NONE))
#define MULTU VR4300_BUILD_OP(MULTU, INFO1(NONE))
#define NOR VR4300_BUILD_OP(NOR, INFO1(NONE))
#define OR VR4300_BUILD_OP(OR, INFO1(NONE))
#define ORI VR4300_BUILD_OP(ORI, INFO2(NEED_RS, WRITE_RT))
#define SB VR4300_BUILD_OP(SB, INFO1(NONE))
#define SC VR4300_BUILD_OP(SC, INFO1(NONE))
#define SCD VR4300_BUILD_OP(SCD, INFO1(NONE))
#define SD VR4300_BUILD_OP(SD, INFO1(NONE))
#define SDC0 VR4300_BUILD_OP(SDC0, INFO1(NONE))
#define SDC1 VR4300_BUILD_OP(SDC1, INFO1(NONE))
#define SDC2 VR4300_BUILD_OP(SDC2, INFO1(NONE))
#define SDL VR4300_BUILD_OP(SDL, INFO1(NONE))
#define SDR VR4300_BUILD_OP(SDR, INFO1(NONE))
#define SH VR4300_BUILD_OP(SH, INFO1(NONE))
#define SLL VR4300_BUILD_OP(SLL, INFO1(NONE))
#define SLLV VR4300_BUILD_OP(SLLV, INFO1(NONE))
#define SLT VR4300_BUILD_OP(SLT, INFO1(NONE))
#define SLTI VR4300_BUILD_OP(SLTI, INFO1(NONE))
#define SLTIU VR4300_BUILD_OP(SLTIU, INFO1(NONE))
#define SLTU VR4300_BUILD_OP(SLTU, INFO1(NONE))
#define SRA VR4300_BUILD_OP(SRA, INFO1(NONE))
#define SRAV VR4300_BUILD_OP(SRAV, INFO1(NONE))
#define SRL VR4300_BUILD_OP(SRL, INFO1(NONE))
#define SRLV VR4300_BUILD_OP(SRLV, INFO1(NONE))
#define SUB VR4300_BUILD_OP(ADD_ADDU_SUB_SUBU, INFO1(NONE))
#define SUBU VR4300_BUILD_OP(ADD_ADDU_SUB_SUBU, INFO1(NONE))
#define SW VR4300_BUILD_OP(SW, INFO1(NONE))
#define SWC0 VR4300_BUILD_OP(SWC0, INFO1(NONE))
#define SWC1 VR4300_BUILD_OP(SWC1, INFO1(NONE))
#define SWC2 VR4300_BUILD_OP(SWC2, INFO1(NONE))
#define SWL VR4300_BUILD_OP(SWL, INFO1(NONE))
#define SWR VR4300_BUILD_OP(SWR, INFO1(NONE))
#define SYNC VR4300_BUILD_OP(SYNC, INFO1(NONE))
#define SYSCALL VR4300_BUILD_OP(SYSCALL, INFO1(NONE))
#define TEQ VR4300_BUILD_OP(TEQ, INFO1(NONE))
#define TEQI VR4300_BUILD_OP(TEQI, INFO1(NONE))
#define TGE VR4300_BUILD_OP(TGE, INFO1(NONE))
#define TGEI VR4300_BUILD_OP(TGEI, INFO1(NONE))
#define TGEIU VR4300_BUILD_OP(TGEIU, INFO1(NONE))
#define TGEU VR4300_BUILD_OP(TGEU, INFO1(NONE))
#define TLT VR4300_BUILD_OP(TLT, INFO1(NONE))
#define TLTI VR4300_BUILD_OP(TLTI, INFO1(NONE))
#define TLTIU VR4300_BUILD_OP(TLTIU, INFO1(NONE))
#define TLTU VR4300_BUILD_OP(TLTU, INFO1(NONE))
#define TNE VR4300_BUILD_OP(TNE, INFO1(NONE))
#define TNEI VR4300_BUILD_OP(TNEI, INFO1(NONE))
#define XOR VR4300_BUILD_OP(XOR, INFO1(NONE))
#define XORI VR4300_BUILD_OP(XORI, INFO1(NONE))

#endif

